SELECT T2.ID, T1.AGE, T1.COIN, T1.POW
FROM
(
    SELECT WP.AGE AS AGE, MIN(W.COINS_NEEDED) AS COIN, W.[POWER] AS POW
    FROM Wands AS W
    INNER JOIN Wands_Property AS WP ON W.CODE = WP.CODE 
    WHERE IS_EVIL = 0
    GROUP BY WP.AGE, W.[POWER]
) AS T1
INNER JOIN
(
    SELECT W.ID AS ID, W.COINS_NEEDED AS COIN, WP.AGE AS AGE
    FROM Wands AS W
    INNER JOIN Wands_Property AS WP ON W.CODE = WP.CODE 
    WHERE IS_EVIL = 0
) AS T2
ON T1.COIN=T2.COIN AND T1.AGE=T2.AGE
ORDER BY T1.POW DESC, T1.AGE DESC
